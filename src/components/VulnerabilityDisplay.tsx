import { Col, Row } from "react-bootstrap";

import { IVulnerabilityType } from "@/types/vulnerability";
import { useMemo } from "react";
import VulnerabilityCard from "./VulnerabilityCard";
import VulnerabilityTable from "./VulnerabilityTable";

interface VulnerabilityDisplayProps {
  vulnerabilities: IVulnerabilityType[];
  onVulnerabilityClick?: (vulnerability: IVulnerabilityType) => void;
}

export default function VulnerabilityDisplay({
  vulnerabilities,
  onVulnerabilityClick
}: VulnerabilityDisplayProps) {
  const sortedVul = useMemo(() => {
    vulnerabilities.sort(
      (a, b) =>
        new Date(b.publishedDate).getTime() -
        new Date(a.publishedDate).getTime()
    );

    return vulnerabilities;
  }, [vulnerabilities]);

  return (
    <>
      {/* Table view for large screens (lg and above) */}
      <div className='d-none d-lg-block'>
        <div className='mb-3'></div>
        <VulnerabilityTable
          vulnerabilities={sortedVul}
          onVulnerabilityClick={onVulnerabilityClick}
        />
      </div>

      {/* Card view for mobile and tablet (below lg) */}
      <div className='d-lg-none'>
        <div className='mb-3'></div>
        <Row className='g-4'>
          {sortedVul.map((vulnerability) => (
            <Col key={vulnerability.id} xs={12} sm={6}>
              <VulnerabilityCard
                vulnerability={vulnerability}
                onVulnerabilityClick={onVulnerabilityClick}
              />
            </Col>
          ))}
        </Row>
      </div>
    </>
  );
}
